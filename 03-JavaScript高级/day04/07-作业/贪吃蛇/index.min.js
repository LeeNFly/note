/**
 * Created by luodianlei on 2018/6/25.
 */
var Tool={getRandom:function(min,max){return Math.floor(Math.random()*(max-min+1))+min}};(function(){var container;function Food(obj){obj=obj||{};this.width=obj.width||20;this.height=obj.height||20;this.bgc=obj.bgc||"green";this.x=obj.x||0;this.y=obj.y||0}Food.prototype.render=function(){if(container){map.removeChild(container)}var div=document.createElement("div");container=div;div.style.width=this.width+"px";div.style.height=this.height+"px";div.style.backgroundColor=this.bgc;this.x=Tool.getRandom(0,map.offsetWidth/this.width-1)*this.width;this.y=Tool.getRandom(0,map.offsetHeight/this.height-1)*this.height;div.style.left=this.x+"px";div.style.top=this.y+"px";div.style.position="absolute";map.appendChild(div)};window.Food=Food})();(function(){var arr=[];function Snake(obj){obj=obj||{};this.width=obj.width||20;this.height=obj.height||20;this.direction="right";this.body=[{x:3,y:2,col:"red"},{x:2,y:2,col:"blue"},{x:1,y:2,col:"blue"}]}Snake.prototype.render=function(){for(var i=0,leng=arr.length;i<leng;i++){map.removeChild(arr[0]);arr.splice(0,1)}this.body.forEach(function(item){var div=document.createElement("div");arr.push(div);div.style.width=this.width+"px";div.style.height=this.height+"px";div.style.backgroundColor=item.col;div.style.left=item.x*this.width+"px";div.style.top=item.y*this.height+"px";div.style.position="absolute";map.appendChild(div)}.bind(this))};Snake.prototype.move=function(){for(var i=this.body.length-1;i>0;i--){this.body[i].x=this.body[i-1].x;this.body[i].y=this.body[i-1].y}switch(this.direction){case"left":this.body[0].x-=1;break;case"right":this.body[0].x+=1;break;case"top":this.body[0].y-=1;break;case"bottom":this.body[0].y+=1;break}};window.Snake=Snake})();(function(){function Game(){this.food=new Food();this.snake=new Snake()}Game.prototype.start=function(){this.food.render();this.snake.render();var timeid=setInterval(function(){this.snake.move();var maxX=map.offsetWidth/this.snake.width-1;var maxY=map.offsetHeight/this.snake.height-1;var head=this.snake.body[0];if(head.x<0||head.y<0||head.x>maxX||head.y>maxY){alert("game over");clearInterval(timeid);return}var x=this.snake.body[0].x*this.snake.width;var y=this.snake.body[0].y*this.snake.height;if(this.food.x==x&&this.food.y==y){this.food.render();var last=this.snake.body[this.snake.body.length-1];this.snake.body.push({x:last.x,y:last.y,col:last.col})}this.snake.render()}.bind(this),150);document.onkeydown=function(e){switch(e.keyCode){case 37:if(this.snake.direction==="right"){break}this.snake.direction="left";break;case 38:if(this.snake.direction==="bottom"){break}this.snake.direction="top";break;case 39:if(this.snake.direction==="left"){break}this.snake.direction="right";break;case 40:if(this.snake.direction==="top"){break}this.snake.direction="bottom";break}}.bind(this)};window.Game=Game})();